<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Shared tools · CodonMolecularEvolution.jl</title><meta name="title" content="Shared tools · CodonMolecularEvolution.jl"/><meta property="og:title" content="Shared tools · CodonMolecularEvolution.jl"/><meta property="twitter:title" content="Shared tools · CodonMolecularEvolution.jl"/><meta name="description" content="Documentation for CodonMolecularEvolution.jl."/><meta property="og:description" content="Documentation for CodonMolecularEvolution.jl."/><meta property="twitter:description" content="Documentation for CodonMolecularEvolution.jl."/><meta property="og:url" content="https://MurrellGroup.github.io/CodonMolecularEvolution.jl/shared/"/><meta property="twitter:url" content="https://MurrellGroup.github.io/CodonMolecularEvolution.jl/shared/"/><link rel="canonical" href="https://MurrellGroup.github.io/CodonMolecularEvolution.jl/shared/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="CodonMolecularEvolution.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CodonMolecularEvolution.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../difFUBAR/">difFUBAR</a></li><li class="is-active"><a class="tocitem" href>Shared tools</a><ul class="internal"><li><a class="tocitem" href="#Tree-importing"><span>Tree importing</span></a></li><li><a class="tocitem" href="#Model-fitting"><span>Model fitting</span></a></li><li><a class="tocitem" href="#Misc"><span>Misc</span></a></li></ul></li><li><a class="tocitem" href="../dataprep/">Data preparation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Shared tools</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Shared tools</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MurrellGroup/CodonMolecularEvolution.jl/blob/main/docs/src/shared.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Shared-tools"><a class="docs-heading-anchor" href="#Shared-tools">Shared tools</a><a id="Shared-tools-1"></a><a class="docs-heading-anchor-permalink" href="#Shared-tools" title="Permalink"></a></h1><p>These tools are shared between the models.</p><h2 id="Tree-importing"><a class="docs-heading-anchor" href="#Tree-importing">Tree importing</a><a id="Tree-importing-1"></a><a class="docs-heading-anchor-permalink" href="#Tree-importing" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CodonMolecularEvolution.import_colored_figtree_nexus_as_tagged_tree" href="#CodonMolecularEvolution.import_colored_figtree_nexus_as_tagged_tree"><code>CodonMolecularEvolution.import_colored_figtree_nexus_as_tagged_tree</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">import_colored_figtree_nexus_as_tagged_tree(fname; custom_labels=String[])</code></pre><p>Takes a nexus file from FigTree, where branches have been colored. Replaces all color tags with group tags that can be used in the models. Can add custom labels too. Should consider an entire custom dictionary as well in future.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; treestring, tags, tag_colors = import_colored_figtree_nexus_as_tagged_tree(&quot;data/Ace2_no_background.nex&quot;)
(&quot;(((XM_027533928_Bos_indicus_x_Bos_taurus{G1}:0.097072,(XM_042974087_Panthera_tigris{G1}:0.038016,... more ...;&quot;, [&quot;{G2}&quot;, &quot;{G1}&quot;], [&quot;#ff0015&quot;, &quot;#0011ff&quot;])</code></pre><div class="admonition is-info" id="Note-3aad5efe2df275e9"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-3aad5efe2df275e9" title="Permalink"></a></header><div class="admonition-body"><p><code>treestring</code> is truncated. <a href="https://raw.githubusercontent.com/MurrellGroup/CodonMolecularEvolution.jl/main/test/data/Ace2_no_background/Ace2_no_background.nex">NEXUS tree file</a></p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MurrellGroup/CodonMolecularEvolution.jl/blob/57d06a39e2f1978b2332b075dc3fb8522ce88084/src/shared/shared.jl#L14-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CodonMolecularEvolution.import_grouped_label_tree" href="#CodonMolecularEvolution.import_grouped_label_tree"><code>CodonMolecularEvolution.import_grouped_label_tree</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">import_grouped_label_tree(tree_file)</code></pre><p>Takes a Newick tree file and return Newick tree, Newick tree with replaced tags, group tags, original tags, and randomly generated colours for each tag</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MurrellGroup/CodonMolecularEvolution.jl/blob/57d06a39e2f1978b2332b075dc3fb8522ce88084/src/shared/shared.jl#L150-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CodonMolecularEvolution.import_labeled_phylotree_newick" href="#CodonMolecularEvolution.import_labeled_phylotree_newick"><code>CodonMolecularEvolution.import_labeled_phylotree_newick</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">import_labeled_phylotree_newick(fname)</code></pre><p>Import a tagged phylogeny from phylotree and return the treestring and tags.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MurrellGroup/CodonMolecularEvolution.jl/blob/57d06a39e2f1978b2332b075dc3fb8522ce88084/src/shared/shared.jl#L186-L190">source</a></section></article><h2 id="Model-fitting"><a class="docs-heading-anchor" href="#Model-fitting">Model fitting</a><a id="Model-fitting-1"></a><a class="docs-heading-anchor-permalink" href="#Model-fitting" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CodonMolecularEvolution.optimize_MG94_F3x4" href="#CodonMolecularEvolution.optimize_MG94_F3x4"><code>CodonMolecularEvolution.optimize_MG94_F3x4</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimize_MG94_F3x4(seqnames, seqs, tree; leaf_name_transform=x -&gt; x, genetic_code=MolecularEvolution.universal_code)</code></pre><p>Optimizes the MG94+F3x4 model on a tree, given a set of sequences and a tree. Returns the optimized tree, alpha, beta, nuc<em>matrix, F3x4, and eq</em>freqs. The leaf<em>name</em>transform kwarg can be used to transform the leaf names in the tree to match the seqnames.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MurrellGroup/CodonMolecularEvolution.jl/blob/57d06a39e2f1978b2332b075dc3fb8522ce88084/src/shared/shared.jl#L201-L206">source</a></section></article><h2 id="Misc"><a class="docs-heading-anchor" href="#Misc">Misc</a><a id="Misc-1"></a><a class="docs-heading-anchor-permalink" href="#Misc" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../difFUBAR/">« difFUBAR</a><a class="docs-footer-nextpage" href="../dataprep/">Data preparation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.0 on <span class="colophon-date" title="Saturday 10 May 2025 23:21">Saturday 10 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
